const {
  openBrowser,
  goto,
  press,
  write,
  click,
  closeBrowser,
  waitFor,
  below,
  accept,
  confirm
} = require("taiko");

const deleteProjects = async (projectName = "Test Project") => {
  try {
    // Login
    await openBrowser({ headless: false, observe: false });
    await goto("http://localhost:3000/");
    await press("Tab");
    await write("admin");
    await press("Tab");
    await write("admin");
    await press("Enter");
    await waitFor(5000);
    await goto("http://localhost:3000/");

    // Delete Projects
    while (await $(`//*[text()='Test Project']`).exists()) {
      prompt(
        "To delete a project is irreversible. Enter the project name to confirm deletion:",
        async () => await accept(projectName)
      );
      confirm(
        ('Are you sure? The project "' + projectName + '" will be gone forever. Tip: You may need to refresh the browser to see the changes.'),
        async () => await accept()
      );
      await click("Delete Project", below(projectName));
      await goto("http://localhost:3000/");
    }
  } catch (error) {
    console.error(error);
  } finally {
    await closeBrowser();
  }
};

deleteProjects()